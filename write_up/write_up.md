# Anti-Analysis Techniques

## What will be covered in this write up?
- [Process Names](#process-names)
- [Process VersionInfo](#process-versioninfo)
- [Debugger Detection](#debugger-detection)
- [Virtual MAchine Detection](#virtual-machine-detection)

> In this write-up we will be covering some common techniques malware authors often utilize in order to identify if their executable is being analyzed. Malware authors will often use these checks to make their malware act benign or simply do nothing/ self delete.


### Process Names

> We will start off this section with probably the easiest method a malware developer can use to thwart a reverse engineers efforts, looking for the process names of analysis tools. Typically malware authors won't be lazy like myself and just simply look for strings of tool file names i.e: Autoruns64.exe or Procmon64.exe... In this case you are lucky, as this is simply an example you can simply look at the dissassembled code to find the subroutine that conducts this check.

>To set the scene, you are a malware analyst that has just been passed a sample piece of malware that is said to open a powershell console on a users computer.

>With an instance of procmon opened, attempt to run the anti_analysis_1.exe and notice that the it should result in the creation of a notepad process. But
![alt text](https://raw.githubusercontent.com/potato4974/Malware-Anti-Analysis/main/write_up/images/Process%20Names/Create_Notepad.PNG?w=300&h=300)

>In this initial example, we'll simply search for strings like, Autoruns64.exe, procmon.exe, procexp64.exe to find the subroutine in the dissassembled code that conducts the executable name check.
![alt text](https://raw.githubusercontent.com/potato4974/Malware-Anti-Analysis/main/write_up/images/Process%20Names/assembly.png)

[CreateToolhelp32Snapshot](https://learn.microsoft.com/en-us/windows/win32/api/tlhelp32/nf-tlhelp32-createtoolhelp32snapshot)

The following function was used to create a snapshot of all of the processes currently running on the victim machine.

### Process VersionInfo

### Debugger Detection

### Virtual Machine Detection
